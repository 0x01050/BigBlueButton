<template name="main">
   <head>
      <title>BigBlueButton Meteor</title>
   </head>
   <body>
      <div>
         {{>header}}
      </div>
      <div id="main" class="row-fluid">
         {{> usersList}}
         {{> chatbar}}
         {{> whiteboard}}
      </div>
   </body>
   {{doFinalStuff}}
   <audio id="remote-media" autoplay="autoplay" ></audio>
</template>

<template name="header">
   {{#if getInSession "display_navbar"}}
      <div class="navbar navbar-default navbar-static-top" role="navigation">
         {{#with getCurrentUser}}
            {{#if getInSession "display_usersList"}}
               {{> makeButton id=user.externUserId btn_class="navbarIconToggleActive usersListIcon navbar-brand" i_class="user" _id=_id}}
            {{else}}
               {{> makeButton id=user.externUserId btn_class="usersListIcon navbar-brand" i_class="user" _id=_id}}
            {{/if}}
            
            {{#if getInSession "display_chatbar"}}
               {{> makeButton id=user.externUserId btn_class="navbarIconToggleActive chatBarIcon navbar-brand" i_class="comment" _id=_id}}
            {{else}}
               {{> makeButton id=user.externUserId btn_class="chatBarIcon navbar-brand" i_class="comment" _id=_id}}
            {{/if}}

            {{#if isUserSharingVideo user}}
               {{> makeButton id=user.externUserId btn_class="navbarIconToggleActive videoFeedIcon navbar-brand" i_class="facetime-video" sharingVideo=true _id=_id}}
            {{else}}
               {{> makeButton id=user.externUserId btn_class="videoFeedIcon navbar-brand" i_class="stop" sharingVideo=false _id=_id}}
            {{/if}}

            {{#if isUserSharingAudio user}}
               {{> makeButton id=user.externUserId btn_class="navbarIconToggleActive audioFeedIcon navbar-brand" i_class="volume-up" sharingAudio=true _id=_id}}
            {{else}}
               {{> makeButton id=user.externUserId btn_class="audioFeedIcon navbar-brand" i_class="volume-off" sharingAudio=false _id=_id}}
            {{/if}}
            {{> makeButton id="" btn_class="hideNavbarIcon pull-right navbar-brand" i_class="chevron-up"}}
            {{> makeButton id="user.externUserId" btn_class="signOutIcon pull-right navbar-brand" i_class="log-out"}}
            {{> makeButton id="user.externUserId" btn_class="settingsIcon pull-right navbar-brand" i_class="cog"}}
            
            {{#if isUserTalking user}}
               <span>TALKING</span>
            {{else}}
               <span>NO TALKING</span>
            {{/if}}
         {{/with}}
      </div>
   {{else}}
      <!-- User wants to hide navbar. The button for bringing the navbar back needs to still be available. Perhaps it should appear/disappear in the future on hover? Something to add later. -->
      {{> makeButton id="" btn_class="hideNavbarIcon pull-right navbar-brand" i_class="chevron-down"}}
   {{/if}}
</template>

<template name="makeButton">
   <button type="submit" id="{{id}}" class="{{btn_class}} btn" {{isDisabled}}>
      <i class="glyphicon glyphicon-{{i_class}}"></i>
   </button>
</template>

